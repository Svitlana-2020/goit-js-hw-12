{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/refs.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst apiKey = '44855126-e7e59ad0378cdd72f172648f5';\nexport const params = {\n        key: apiKey,\n        q: \"\",\n        page: 1,\n        per_page: 15,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        maxPage: 0,\n    }\n\naxios.defaults.baseURL = \"https://pixabay.com/api/\";\n\n        export async function getPictureByQuery(query) {\n                const response = await axios.get(\"\", { params })\n                .then (({data}) => data);\n                // console.log(response);\n                return response;\n      }\n       \n                            // if (!response.ok) {\n                            //     throw new Error (response.status);\n                            // }\n                            // console.log(response);\n                            // return await response.json();\n                            //     }\n\n                            // (`https://pixabay.com/api/?key=${apiKey}&q=${query}&image_type=\"photo\"&orientation=\"horizontal\"&safesearch=\"true\"`)\n                              \n    \n","export const refs = {\n    inputQ: document.querySelector('.input'),\n    galleryCard: document.querySelector('.list-class'),\n    searchBtn: document.querySelector('.start-btn'),\n    formForm: document.querySelector('.input-button'),\n    loader: document.querySelector('.loader'),\n    loadMoreBtn: document.querySelector('.load-more-btn'),\n    }\n\n","\n// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { refs } from \"./refs\";\n\nimport axios, {isCancel, AxiosError} from 'axios';\n\nexport const lightbox = new SimpleLightbox('.gallery-item a', {\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    spinner: true,\n  });\n\nexport function renderGalleryMarkup(array) {\n    const markUp = array.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) => `\n    <li class = \"gallery-item\">\n    \n    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <div class=\"img-container\">\n            <img \n                class=\"gallery-img\" \n                src=\"${webformatURL}\" \n                alt=\"${tags}\" \n                />\n                </div>\n        </a>\n       \n        <div class=\"numbers-group\">\n                 <span class=\"group\">\n        <p class=\"numbers\">Likes</p>\n        <p class=\"number\">${likes}</p>\n                </span>\n                    <span class=\"group\">\n        <p class=\"numbers\">Views</p>\n         <p class=\"number\">${views}</p>\n                    </span>\n                    <span class=\"group\">\n        <p class=\"numbers\">Comments</p>\n        <p class=\"number\">${comments}</p>\n                    </span>\n                    <span class=\"group\">\n        <p class=\"numbers\">Downloads</p>\n        <p class=\"number\">${downloads}</p>\n                    </span>\n        </div>\n    </li>\n    `  ).join('');\n    refs.galleryCard.insertAdjacentHTML('beforeend', markUp);\n    lightbox.refresh();\n    }","// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getPictureByQuery, params } from \"./js/pixabay-api\";\nimport { lightbox, renderGalleryMarkup } from \"./js/render-functions\";\nimport { refs } from \"./js/refs\";\n\n\nrefs.formForm.addEventListener('submit', handleSearch);\nrefs.loadMoreBtn.addEventListener('click', loadMore);\n\n           async function handleSearch(e) {\n                        e.preventDefault();\n                        const form = e.currentTarget;\n                        params.q = form.elements.inputf.value.trim();\n                        refs.galleryCard.innerHTML = '';\n                        refs.loader.classList.remove('hidden');\n                        refs.loadMoreBtn.classList.add('hidden');\n                        params.page = 1;\n                        if (params.q === \"\") {\n                            {\n                                \n                                iziToast.show({\n                                    message: '\"Enter a search query in a search field. Pls try again\"',\n                                    messageColor: 'white',\n                                    messageLineHeight: '150%',\n                                    backgroundColor: '#ef4040',\n                                    position: 'topRight'\n                                            })\n                                    }\n                                    return;\n                        }\n                        \n                        try {\n                            const dataResponse = await getPictureByQuery(params);\n                            const { hits, totalHits } = dataResponse;\n                            console.log(hits, totalHits);\n                            params.maxPage = Math.floor(totalHits / params.per_page);\n                            console.log(params.maxPage);\n                            \n                            if (hits && hits.length > 0) {\n                                renderGalleryMarkup(hits);\n                                refs.loadMoreBtn.classList.remove('hidden');\n                                \n                            } else {\n                                throw new Error('No images found');\n                            }\n                        } catch (error) {;\n                            fetchError(error);\n                        } finally {\n                            refs.loader.classList.add('hidden');\n                            form.reset(); // Сброс формы даже в случае ошибки\n                        }\n                    }\n\n                    function fetchError(error) {\n                        iziToast.show({\n                            message: '\"Sorry, there are no images matching your search query. Please try again!\"',\n                            messageColor: 'white',\n                            messageLineHeight: '150%',\n                            backgroundColor: '#ef4040',\n                            position: 'topRight'\n                                    })\n                            }\n\n\nasync function loadMore() {\n    params.page += 1;\n    refs.loader.classList.remove('hidden');\n\n    try {\n        const dataResponse = await getPictureByQuery(params);\n        const { hits } = dataResponse;\n        console.log(hits);\n        \n        if (hits && hits.length > 0) {\n            renderGalleryMarkup(hits);\n            refs.loadMoreBtn.classList.remove('hidden');\n        } else {\n            throw new Error('No images found');\n        }\n    } catch (error) {;\n        fetchError(error);\n    }\n    finally {\n        refs.loader.classList.add('hidden');\n        if (params.maxPage === params.page){\n            iziToast.show({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                messageColor: 'white',\n                messageLineHeight: '150%',\n                backgroundColor: '#ef4040',\n                position: 'topRight'\n                        })\n\n        }\n        refs.loadMoreBtn.classList.add('hidden');\n        // form.reset(); // Сброс формы даже в случае ошибки\n    }\n}\n\n"],"names":["apiKey","params","axios","getPictureByQuery","query","data","refs","lightbox","SimpleLightbox","renderGalleryMarkup","array","markUp","webformatURL","largeImageURL","tags","likes","views","comments","downloads","handleSearch","loadMore","e","form","iziToast","dataResponse","hits","totalHits","fetchError","error"],"mappings":"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"}