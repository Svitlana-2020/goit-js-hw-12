{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/refs.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst apiKey = '44855126-e7e59ad0378cdd72f172648f5';\nexport const params = {\n        key: apiKey,\n        q: \"\",\n        page: 1,\n        per_page: 15,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        maxPage: 0,\n    }\n\naxios.defaults.baseURL = \"https://pixabay.com/api/\";\n\n        export async function getPictureByQuery(query) {\n                const response = await axios.get(\"\", { params })\n                .then (({data}) => data);\n                // console.log(response);\n                return response;\n      }\n       \n                            // if (!response.ok) {\n                            //     throw new Error (response.status);\n                            // }\n                            // console.log(response);\n                            // return await response.json();\n                            //     }\n\n                            // (`https://pixabay.com/api/?key=${apiKey}&q=${query}&image_type=\"photo\"&orientation=\"horizontal\"&safesearch=\"true\"`)\n                              \n    \n","export const refs = {\n    inputQ: document.querySelector('.input'),\n    galleryCard: document.querySelector('.list-class'),\n    searchBtn: document.querySelector('.start-btn'),\n    formForm: document.querySelector('.input-button'),\n    loader: document.querySelector('.loader'),\n    loadMoreBtn: document.querySelector('.load-more-btn'),\n    gallery: document.querySelector('.gallery'),\n    // galleryItem: document.querySelector('.gallery-item'),\n    }\n\n","\n// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { refs } from \"./refs\";\n\nimport axios, {isCancel, AxiosError} from 'axios';\n\nexport const lightbox = new SimpleLightbox('.gallery-item a', {\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    spinner: true,\n  });\n\nexport function renderGalleryMarkup(array) {\n    const markUp = array.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) => `\n    <li class = \"gallery-item\">\n    \n    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <div class=\"img-container\">\n            <img \n                class=\"gallery-img\" \n                src=\"${webformatURL}\" \n                alt=\"${tags}\" \n                />\n                </div>\n        </a>\n       \n        <div class=\"numbers-group\">\n                 <span class=\"group\">\n        <p class=\"numbers\">Likes</p>\n        <p class=\"number\">${likes}</p>\n                </span>\n                    <span class=\"group\">\n        <p class=\"numbers\">Views</p>\n         <p class=\"number\">${views}</p>\n                    </span>\n                    <span class=\"group\">\n        <p class=\"numbers\">Comments</p>\n        <p class=\"number\">${comments}</p>\n                    </span>\n                    <span class=\"group\">\n        <p class=\"numbers\">Downloads</p>\n        <p class=\"number\">${downloads}</p>\n                    </span>\n        </div>\n    </li>\n    `  ).join('');\n    refs.galleryCard.insertAdjacentHTML('beforeend', markUp);\n    lightbox.refresh();\n    }","// Описаний у документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getPictureByQuery, params } from './js/pixabay-api';\nimport { lightbox, renderGalleryMarkup } from './js/render-functions';\nimport { refs } from './js/refs';\n\nrefs.formForm.addEventListener('submit', handleSearch);\nrefs.loadMoreBtn.addEventListener('click', loadMore);\n\nasync function handleSearch(e) {\n  e.preventDefault();\n  const form = e.currentTarget;\n  params.q = form.elements.inputf.value.trim();\n  refs.loader.classList.remove('hidden');\n  refs.galleryCard.innerHTML = '';\n  params.page = 1;\n  if (params.q === '') {\n    refs.loader.classList.add('hidden');\n    {\n      iziToast.show({\n        message: '\"Enter a search query in a search field. Pls try again\"',\n        messageColor: 'white',\n        messageLineHeight: '150%',\n        backgroundColor: '#ef4040',\n        position: 'topRight',\n      });\n    }\n    return;\n  }\n\n  refs.gallery.scrollBy({\n    top: 1000,\n    behavior: \"smooth\",\n  });\n\n  refs.loadMoreBtn.classList.add('hidden');\n\n  try {\n    const dataResponse = await getPictureByQuery(params);\n    const { hits } = dataResponse;\n    console.log(hits);\n\n    // params.maxPage = Math.floor(totalHits / params.per_page);\n    // console.log(params.maxPage);\n\n    if (hits && hits.length > 0) {\n      renderGalleryMarkup(hits);\n\n      refs.loadMoreBtn.classList.remove('hidden');\n    } else {\n      throw new Error('No images found');\n    }\n  } catch (error) {\n    fetchError(error);\n  } finally {\n    refs.loader.classList.add('hidden');\n    form.reset(); // Сброс формы даже в случае ошибки\n  }\n}\n\nfunction fetchError(error) {\n  iziToast.show({\n    message:\n      '\"Sorry, there are no images matching your search query. Please try again!\"',\n    messageColor: 'white',\n    messageLineHeight: '150%',\n    backgroundColor: '#ef4040',\n    position: 'topRight',\n  });\n}\n\nasync function loadMore(e) {\n\n  // if (params.maxPage === params.page) {\n  //   refs.loader.classList.add('hidden');\n  //   refs.loadMoreBtn.classList.add('hidden');\n  //   iziToast.show({\n  //     message: \"We're sorry, but you've reached the end of search results.\",\n  //     messageColor: 'white',\n  //     messageLineHeight: '150%',\n  //     backgroundColor: '#ef4040',\n  //     position: 'topRight',\n  //   });\n  //   return;\n  // }\n\n  refs.loader.classList.remove('hidden');\n \n  params.page += 1;\n\n  try {\n    const dataResponse = await getPictureByQuery(params);\n    const { hits, totalHits } = dataResponse;\n    console.log(hits, totalHits);\n\n    params.maxPage = Math.ceil(totalHits / params.per_page);\n\n      if (params.maxPage < params.page) {\n    refs.loader.classList.add('hidden');\n    refs.loadMoreBtn.classList.add('hidden');\n    iziToast.show({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      messageColor: 'white',\n      messageLineHeight: '150%',\n      backgroundColor: '#ef4040',\n      position: 'topRight',\n    });\n    return;\n  }\n\n      renderGalleryMarkup(hits);\n\n      const galleryItem = document.querySelector('.gallery-item');\n      const cardHeight = galleryItem.getBoundingClientRect().height;\n      const cardHeightValue = cardHeight * 2;\n\n      window.scrollBy({\n        top: cardHeightValue,\n        behavior: \"smooth\",\n      });\n\n      refs.loadMoreBtn.classList.remove('hidden');\n\n  } catch (error) {\n    fetchError(error);\n  } finally {\n    refs.loader.classList.add('hidden');\n    // form.reset(); // Сброс формы даже в случае ошибки\n  }\n}\n"],"names":["apiKey","params","axios","getPictureByQuery","query","data","refs","lightbox","SimpleLightbox","renderGalleryMarkup","array","markUp","webformatURL","largeImageURL","tags","likes","views","comments","downloads","handleSearch","loadMore","e","form","iziToast","dataResponse","hits","fetchError","error","totalHits","cardHeightValue"],"mappings":"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"}